import pandas as pd
import sqlite3

def pull_db(query,db_name):
    # Connect to your SQLite database
    conn = sqlite3.connect(db_name)  # Replace with your actual database file name


    # Execute the query and read the results into a DataFrame
    df = pd.read_sql_query(query, conn)

    # Close the database connection
    conn.close()
    
    return df

if __name__ == '__main__':
    
    db_name = r'NFL_stats\database\2023_database.db'
    
    query = '''
    SELECT players.Player, rushing.TD, teams.team_name
    FROM players
    INNER JOIN teams ON players.Team = teams.team_id
    INNER JOIN rushing ON players.player_id = rushing.Player
    ORDER BY rushing.TD DESC;
    '''
    rushing_TDs_df = pull_db(query,db_name)
    print(rushing_TDs_df.sort_values(by='TD', ascending=False))